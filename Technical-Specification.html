
<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="generator" content="LaTeX Lwarp package" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<title>main — Technical Specification</title>
<link rel="stylesheet" type="text/css" href="sans-serif-lwarp-sagebrush.css" />

<script>
// Lwarp MathJax emulation code
//
// Based on code by Davide P. Cervone.
// Equation numbering: https://github.com/mathjax/MathJax/issues/2427
// Starred and ifnextchar macros: https://github.com/mathjax/MathJax/issues/2428
// \left, \right delimiters: https://github.com/mathjax/MathJax/issues/2535
//
// Modified by Brian Dunn to adjust equation numbering and add subequations.
//
// LaTeX can use \seteqnumber{subequations?}{section}{number} before each equation.
// subequations? is 0 usually, 1 if inside subequations.
// section is a string printed as-is, or empty.
// number is auto-incremented by MathJax between equations.
//
MathJax = {
    subequations: "0",
    section: "",
    loader: {
        load: ['[tex]/tagformat', '[tex]/textmacros'],
    },
    startup: {
        ready() {
            //      These would be replaced by import commands if you wanted to make
            //      a proper extension.
            const Configuration = MathJax._.input.tex.Configuration.Configuration;
            const CommandMap = MathJax._.input.tex.SymbolMap.CommandMap;
            const Macro = MathJax._.input.tex.Symbol.Macro;
            const TexError = MathJax._.input.tex.TexError.default;
            const ParseUtil = MathJax._.input.tex.ParseUtil.default;
            const expandable = MathJax._.util.Options.expandable;


            //      Insert the replacement string into the TeX string, and check
            //      that there haven't been too many maxro substitutions (prevents
            //      infinite loops).
            const useArgument = (parser, text) => {
                parser.string = ParseUtil.addArgs(parser, text, parser.string.slice(parser.i));
                parser.i = 0;
                if (++parser.macroCount > parser.configuration.options.maxMacros) {
                    throw new TexError('MaxMacroSub1',
                    'MathJax maximum macro substitution count exceeded; ' +
                    'is there a recursive macro call?');
                }
            }


            //      Create the command map for:
            //          \ifstar, \ifnextchar, \ifblank, \ifstrequal, \gsub, \seteqnumber
            new CommandMap('Lwarp-macros', {
                ifstar: 'IfstarFunction',
                ifnextchar: 'IfnextcharFunction',
                ifblank: 'IfblankFunction',
                ifstrequal: 'IfstrequalFunction',
                gsubstitute: 'GsubstituteFunction',
                seteqnumber: 'SeteqnumberFunction'
            }, {
                //      This function implements an ifstar macro.
                IfstarFunction(parser, name) {
                    const resultstar = parser.GetArgument(name);
                    const resultnostar = parser.GetArgument(name);
                    const star = parser.GetStar();                      // true if there is a *
                    useArgument(parser, star ? resultstar : resultnostar);
                },


                //      This function implements an ifnextchar macro.
                IfnextcharFunction(parser, name) {
                    let whichchar = parser.GetArgument(name);
                    if (whichchar.match(/^(?:0x[0-9A-F]+|[0-9]+)$/i)) {
                        // $ syntax highlighting
                        whichchar = String.fromCodePoint(parseInt(whichchar));
                    }
                    const resultnextchar = parser.GetArgument(name);
                    const resultnotnextchar = parser.GetArgument(name);
                    const gotchar = (parser.GetNext() === whichchar);
                    useArgument(parser, gotchar ? resultnextchar : resultnotnextchar);
                },


                // This function implements an ifblank macro.
                IfblankFunction(parser, name) {
                    const blankarg = parser.GetArgument(name);
                    const resultblank = parser.GetArgument(name);
                    const resultnotblank = parser.GetArgument(name);
                    const isblank = (blankarg.trim() == "");
                    useArgument(parser, isblank ? resultblank : resultnotblank);
                },


                // This function implements an ifstrequal macro.
                IfstrequalFunction(parser, name) {
                    const strequalfirst = parser.GetArgument(name);
                    const strequalsecond = parser.GetArgument(name);
                    const resultequal = parser.GetArgument(name);
                    const resultnotequal = parser.GetArgument(name);
                    const isequal = (strequalfirst == strequalsecond);
                    useArgument(parser, isequal ? resultequal : resultnotequal);
                },


                // This function implements a gsub macro.
                GsubstituteFunction(parser, name) {
                    const gsubfirst = parser.GetArgument(name);
                    const gsubsecond = parser.GetArgument(name);
                    const gsubthird = parser.GetArgument(name);
                    let gsubresult=gsubfirst.replace(gsubsecond, gsubthird);
                    useArgument(parser, gsubresult);
                },


                //      This function modifies the equation numbers.
                SeteqnumberFunction(parser, name) {
                        //   Get the macro parameters
                        const star = parser.GetStar();                    // true if there is a *
                        const optBrackets = parser.GetBrackets(name);     // contents of optional brackets
                        const newsubequations = parser.GetArgument(name);    // the subequations argument
                        const neweqsection = parser.GetArgument(name);    // the eq section argument
                        const neweqnumber = parser.GetArgument(name);     // the eq number argument
                        MathJax.config.subequations=newsubequations ;     // a string with boolean meaning
                        MathJax.config.section=neweqsection ;             // a string with numeric meaning
                        parser.tags.counter = parser.tags.allCounter = neweqnumber ;
                }


            });


            //      Create the Lwarp-macros package
            Configuration.create('Lwarp-macros', {
                handler: {macro: ['Lwarp-macros']}
            });


            MathJax.startup.defaultReady();


            // For forward references:
            MathJax.startup.input[0].preFilters.add(({math}) => {
                if (math.inputData.recompile){
                        MathJax.config.subequations = math.inputData.recompile.subequations;
                        MathJax.config.section = math.inputData.recompile.section;
                }
            });
            MathJax.startup.input[0].postFilters.add(({math}) => {
                if (math.inputData.recompile){
                        math.inputData.recompile.subequations = MathJax.config.subequations;
                        math.inputData.recompile.section = MathJax.config.section;
                }
            });


                // For \left, \right with unicode-math:
                const {DelimiterMap} = MathJax._.input.tex.SymbolMap;
                const {Symbol} = MathJax._.input.tex.Symbol;
                const {MapHandler} = MathJax._.input.tex.MapHandler;
                const delimiter = MapHandler.getMap('delimiter');
                delimiter.add('\\lBrack', new Symbol('\\lBrack', '\u27E6'));
                delimiter.add('\\rBrack', new Symbol('\\rBrack', '\u27E7'));
                delimiter.add('\\lAngle', new Symbol('\\lAngle', '\u27EA'));
                delimiter.add('\\rAngle', new Symbol('\\rAngle', '\u27EB'));
                delimiter.add('\\lbrbrak', new Symbol('\\lbrbrak', '\u2772'));
                delimiter.add('\\rbrbrak', new Symbol('\\rbrbrak', '\u2773'));
                delimiter.add('\\lbag', new Symbol('\\lbag', '\u27C5'));
                delimiter.add('\\rbag', new Symbol('\\rbag', '\u27C6'));
                delimiter.add('\\llparenthesis', new Symbol('\\llparenthesis', '\u2987'));
                delimiter.add('\\rrparenthesis', new Symbol('\\rrparenthesis', '\u2988'));
                delimiter.add('\\llangle', new Symbol('\\llangle', '\u2989'));
                delimiter.add('\\rrangle', new Symbol('\\rrangle', '\u298A'));
                delimiter.add('\\Lbrbrak', new Symbol('\\Lbrbrak', '\u27EC'));
                delimiter.add('\\Rbrbrak', new Symbol('\\Rbrbrak', '\u27ED'));
                delimiter.add('\\lBrace', new Symbol('\\lBrace', '\u2983'));
                delimiter.add('\\rBrace', new Symbol('\\rBrace', '\u2984'));
                delimiter.add('\\lParen', new Symbol('\\lParen', '\u2985'));
                delimiter.add('\\rParen', new Symbol('\\rParen', '\u2986'));
                delimiter.add('\\lbrackubar', new Symbol('\\lbrackubar', '\u298B'));
                delimiter.add('\\rbrackubar', new Symbol('\\rbrackubar', '\u298C'));
                delimiter.add('\\lbrackultick', new Symbol('\\lbrackultick', '\u298D'));
                delimiter.add('\\rbracklrtick', new Symbol('\\rbracklrtick', '\u298E'));
                delimiter.add('\\lbracklltick', new Symbol('\\lbracklltick', '\u298F'));
                delimiter.add('\\rbrackurtick', new Symbol('\\rbrackurtick', '\u2990'));
                delimiter.add('\\langledot', new Symbol('\\langledot', '\u2991'));
                delimiter.add('\\rangledot', new Symbol('\\rangledot', '\u2992'));
                delimiter.add('\\lparenless', new Symbol('\\lparenless', '\u2993'));
                delimiter.add('\\rparengtr', new Symbol('\\rparengtr', '\u2994'));
                delimiter.add('\\Lparengtr', new Symbol('\\Lparengtr', '\u2995'));
                delimiter.add('\\Rparenless', new Symbol('\\Rparenless', '\u2996'));
                delimiter.add('\\lblkbrbrak', new Symbol('\\lblkbrbrak', '\u2997'));
                delimiter.add('\\rblkbrbrak', new Symbol('\\rblkbrbrak', '\u2998'));
                delimiter.add('\\lvzigzag', new Symbol('\\lvzigzag', '\u29D8'));
                delimiter.add('\\rvzigzag', new Symbol('\\rvzigzag', '\u29D9'));
                delimiter.add('\\Lvzigzag', new Symbol('\\Lvzigzag', '\u29DA'));
                delimiter.add('\\Rvzigzag', new Symbol('\\Rvzigzag', '\u29DB'));
                delimiter.add('\\lcurvyangle', new Symbol('\\lcurvyangle', '\u29FC'));
                delimiter.add('\\rcurvyangle', new Symbol('\\rcurvyangle', '\u29FD'));
                delimiter.add('\\Vvert', new Symbol('\\Vvert', '\u2980'));
        }        // ready
    },           // startup


    tex: {
        packages: {'[+]': ['tagformat', 'Lwarp-macros', 'textmacros']},
        tags: "ams",
                tagformat: {
                        number: function (n) {
                             if(MathJax.config.subequations==0)
                                 return(MathJax.config.section + n);
                             else
                                 return(MathJax.config.section + String.fromCharCode(96+n));
                        },
                },
    }
}
</script>


<script
        id="MathJax-script"
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"
></script>

</head>
<body>


<a id="main-autopage-49"></a>


<div class="bodyandsidetoc2">
<div class="wrap-collabsible">
  <input id="collapsible" class="toggle" type="checkbox" style="opacity:0;">
  <label for="collapsible" class="lbl-toggle"><p class="text">Technical Specification</p></label>
  <div class="collapsible-content">
    <div class="content-inner">
<div class="sidetoccontainer2">


<nav class="sidetoc2">




<div class="sidetoccontents2">

<p class="text">
<a href="main.html" class="linkhome" >
Home</a>
</p>

<p class="text">
<a href="Program-Name.html#autosec-7" class="tocchapter" >
Program Name</a>
</p>


<p class="text">
<a href="Program-Name.html#autosec-9" class="tocsection" >
Executive summary</a>
</p>


<p class="text">
<a href="Business-Design.html#autosec-18" class="tocchapter" >
Business Design</a>
</p>


<p class="text">
<a href="Requirements-Baseline.html#autosec-21" class="tocchapter" >
Requirements Baseline</a>
</p>


<p class="text">
<a href="Physical-properties-edge-plasma.html#autosec-24" class="tocsection" >
Physical properties of the edge plasma</a>
</p>


<p class="text">
<a href="Engineering-Requirements-Baseline.html#autosec-33" class="tocsection" >
Engineering Requirements Baseline</a>
</p>


<p class="text">
<a href="Use-Cases.html#autosec-41" class="tocsection" >
Use Cases</a>
</p>


<p class="text">
<a href="General-Remarks.html#autosec-48" class="tocsection" >
General Remarks</a>
</p>


<p class="text">
<a href="Technical-Specification.html#autosec-51" class="tocchapter" >
Technical Specification</a>
</p>


<p class="text">
<a href="Technical-Specification.html#autosec-53" class="tocsection" >
Response to Tokamak Science Division</a>
</p>


<p class="text">
<a href="Order-magnitude-estimates-tokamak-edge-modelling.html#autosec-96" class="tocsection" >
Order-of-magnitude estimates for tokamak edge modelling</a>
</p>


<p class="text">
<a href="Software-Engineering-Response.html#autosec-99" class="tocsection" >
Software Engineering Response</a>
</p>


<p class="text">
<a href="Generating-Names-Variables.html#autosec-116" class="tocsection" >
Generating Names for Variables</a>
</p>


<p class="text">
<a href="Design-Justification-File.html#autosec-121" class="tocchapter" >
Design Justification File</a>
</p>


<p class="text">
<a href="Design-Justification-File.html#autosec-123" class="tocsection" >
UKAEA (Internal) Reports</a>
</p>


<p class="text">
<a href="Design-Definition-File.html#autosec-132" class="tocchapter" >
Design Definition File</a>
</p>


<p class="text">
<a href="Design-Definition-File.html#autosec-134" class="tocsection" >
Design specification</a>
</p>


<p class="text">
<a href="Objects-classes.html#autosec-137" class="tocsection" >
Objects/classes</a>
</p>


<p class="text">
<a href="Execution-sequence.html#autosec-148" class="tocsection" >
Execution sequence</a>
</p>


<p class="text">
<a href="Design-patterns.html#autosec-158" class="tocsection" >
Design patterns</a>
</p>


<p class="text">
<a href="Management-File.html#autosec-162" class="tocchapter" >
Management File</a>
</p>


<p class="text">
<a href="Introduction.html#autosec-165" class="tocsection" >
Introduction</a>
</p>


<p class="text">
<a href="Management.html#autosec-168" class="tocsection" >
Management</a>
</p>


<p class="text">
<a href="ExCALIBUR-Project-NEPTUNE-Charter.html#autosec-177" class="tocsection" >
<span class="textsc">E</span>x<span class="textsc">CALIBUR</span> Project <span class="textsc">NEPTUNE</span> Charter</a>
</p>


<p class="text">
<a href="Maintenance-File.html#autosec-180" class="tocchapter" >
Maintenance File</a>
</p>


<p class="text">
<a href="Operational-Documentation.html#autosec-183" class="tocchapter" >
Operational Documentation</a>
</p>


<p class="text">
<a href="Operational-Documentation.html#autosec-185" class="tocsection" >
Documentation Generally</a>
</p>


<p class="text">
<a href="Developer-Manual.html#autosec-189" class="tocsection" >
Developer Manual</a>
</p>


<p class="text">
<a href="User-Manual.html#autosec-198" class="tocsection" >
User Manual</a>
</p>


<p class="text">
<a href="User-Manual.html#autosec-200" class="tocsection" >
Feedback and Communication</a>
</p>


<p class="text">
<a href="Proxyapps.html#autosec-203" class="tocchapter" >
Proxyapps</a>
</p>


<p class="text">
<a href="Nektar-Driftwave.html#autosec-206" class="tocsection" >
Nektar-Driftwave</a>
</p>


<p class="text">
<a href="Nektar-Diffusion.html#autosec-209" class="tocsection" >
Nektar-Diffusion</a>
</p>


<p class="text">
<a href="Nektar-1D-SOL.html#autosec-212" class="tocsection" >
Nektar-1D-SOL</a>
</p>


<p class="text">
<a href="FabNEPTUNE.html#autosec-215" class="tocsection" >
FabNEPTUNE</a>
</p>


<p class="text">
<a href="Moment-Kinetics.html#autosec-218" class="tocsection" >
Moment_Kinetics</a>
</p>


<p class="text">
<a href="NESO.html#autosec-221" class="tocsection" >
NESO</a>
</p>


<p class="text">
<a href="Reference-Material.html#autosec-224" class="tocchapter" >
Reference Material</a>
</p>


<p class="text">
<a href="Reference-Material.html#autosec-226" class="tocsection" >
Conventions for Report Writing</a>
</p>


<p class="text">
<a href="Acronyms.html#autosec-235" class="tocsection" >
Acronyms</a>
</p>


<p class="text">
<a href="Symbols.html#autosec-243" class="tocsection" >
Symbols</a>
</p>


<p class="text">
<a href="Videos.html#autosec-254" class="tocchapter" >
Videos</a>
</p>


<p class="text">
<a href="Index-0.html#autosec-257" class="tocchapter" >
Index</a>
</p>


</div>

</nav>

</div>
</div>
</div>
</div>
<div class="bodyandsidetoc"><div class="sidetoccontainer">


<nav class="sidetoc">


<div class="sidetoctitle">

<p>
<span class="sidetocthetitle">main</span>
</p>

<p>
Contents
</p>
</div>


<div class="sidetoccontents">

<p>
<a href="main.html" class="linkhome" >
Home</a>
</p>

<p>
<a href="Program-Name.html#autosec-7" class="tocchapter" >
Program Name</a>
</p>


<p>
<a href="Program-Name.html#autosec-9" class="tocsection" >
Executive summary</a>
</p>


<p>
<a href="Business-Design.html#autosec-18" class="tocchapter" >
Business Design</a>
</p>


<p>
<a href="Requirements-Baseline.html#autosec-21" class="tocchapter" >
Requirements Baseline</a>
</p>


<p>
<a href="Physical-properties-edge-plasma.html#autosec-24" class="tocsection" >
Physical properties of the edge plasma</a>
</p>


<p>
<a href="Engineering-Requirements-Baseline.html#autosec-33" class="tocsection" >
Engineering Requirements Baseline</a>
</p>


<p>
<a href="Use-Cases.html#autosec-41" class="tocsection" >
Use Cases</a>
</p>


<p>
<a href="General-Remarks.html#autosec-48" class="tocsection" >
General Remarks</a>
</p>


<p>
<a href="Technical-Specification.html#autosec-51" class="tocchapter" >
Technical Specification</a>
</p>


<p>
<a href="Technical-Specification.html#autosec-53" class="tocsection" >
Response to Tokamak Science Division</a>
</p>


<p>
<a href="Order-magnitude-estimates-tokamak-edge-modelling.html#autosec-96" class="tocsection" >
Order-of-magnitude estimates for tokamak edge modelling</a>
</p>


<p>
<a href="Software-Engineering-Response.html#autosec-99" class="tocsection" >
Software Engineering Response</a>
</p>


<p>
<a href="Generating-Names-Variables.html#autosec-116" class="tocsection" >
Generating Names for Variables</a>
</p>


<p>
<a href="Design-Justification-File.html#autosec-121" class="tocchapter" >
Design Justification File</a>
</p>


<p>
<a href="Design-Justification-File.html#autosec-123" class="tocsection" >
UKAEA (Internal) Reports</a>
</p>


<p>
<a href="Design-Definition-File.html#autosec-132" class="tocchapter" >
Design Definition File</a>
</p>


<p>
<a href="Design-Definition-File.html#autosec-134" class="tocsection" >
Design specification</a>
</p>


<p>
<a href="Objects-classes.html#autosec-137" class="tocsection" >
Objects/classes</a>
</p>


<p>
<a href="Execution-sequence.html#autosec-148" class="tocsection" >
Execution sequence</a>
</p>


<p>
<a href="Design-patterns.html#autosec-158" class="tocsection" >
Design patterns</a>
</p>


<p>
<a href="Management-File.html#autosec-162" class="tocchapter" >
Management File</a>
</p>


<p>
<a href="Introduction.html#autosec-165" class="tocsection" >
Introduction</a>
</p>


<p>
<a href="Management.html#autosec-168" class="tocsection" >
Management</a>
</p>


<p>
<a href="ExCALIBUR-Project-NEPTUNE-Charter.html#autosec-177" class="tocsection" >
<span class="textsc">E</span>x<span class="textsc">CALIBUR</span> Project <span class="textsc">NEPTUNE</span> Charter</a>
</p>


<p>
<a href="Maintenance-File.html#autosec-180" class="tocchapter" >
Maintenance File</a>
</p>


<p>
<a href="Operational-Documentation.html#autosec-183" class="tocchapter" >
Operational Documentation</a>
</p>


<p>
<a href="Operational-Documentation.html#autosec-185" class="tocsection" >
Documentation Generally</a>
</p>


<p>
<a href="Developer-Manual.html#autosec-189" class="tocsection" >
Developer Manual</a>
</p>


<p>
<a href="User-Manual.html#autosec-198" class="tocsection" >
User Manual</a>
</p>


<p>
<a href="User-Manual.html#autosec-200" class="tocsection" >
Feedback and Communication</a>
</p>


<p>
<a href="Proxyapps.html#autosec-203" class="tocchapter" >
Proxyapps</a>
</p>


<p>
<a href="Nektar-Driftwave.html#autosec-206" class="tocsection" >
Nektar-Driftwave</a>
</p>


<p>
<a href="Nektar-Diffusion.html#autosec-209" class="tocsection" >
Nektar-Diffusion</a>
</p>


<p>
<a href="Nektar-1D-SOL.html#autosec-212" class="tocsection" >
Nektar-1D-SOL</a>
</p>


<p>
<a href="FabNEPTUNE.html#autosec-215" class="tocsection" >
FabNEPTUNE</a>
</p>


<p>
<a href="Moment-Kinetics.html#autosec-218" class="tocsection" >
Moment_Kinetics</a>
</p>


<p>
<a href="NESO.html#autosec-221" class="tocsection" >
NESO</a>
</p>


<p>
<a href="Reference-Material.html#autosec-224" class="tocchapter" >
Reference Material</a>
</p>


<p>
<a href="Reference-Material.html#autosec-226" class="tocsection" >
Conventions for Report Writing</a>
</p>


<p>
<a href="Acronyms.html#autosec-235" class="tocsection" >
Acronyms</a>
</p>


<p>
<a href="Symbols.html#autosec-243" class="tocsection" >
Symbols</a>
</p>


<p>
<a href="Videos.html#autosec-254" class="tocchapter" >
Videos</a>
</p>


<p>
<a href="Index-0.html#autosec-257" class="tocchapter" >
Index</a>
</p>


</div>

</nav>

</div>


<main class="bodycontainer">


<section class="textbody">

 

<!--MathJax customizations:-->


<div class="hidden">

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\let \LWRorighspace \hspace \)

\(\renewcommand {\hspace }{\ifstar \LWRorighspace \LWRorighspace }\)

\(\newcommand {\mathnormal }[1]{{#1}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\arabic }[1]{}\)

\(\newcommand {\number }[1]{}\)

\(\newcommand {\noalign }[1]{\text {#1}\notag \\}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\newcommand {\LWRabsorboption }[1][]{}\)

\(\newcommand {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\def \oe {\unicode {x0153}}\)

\(\def \OE {\unicode {x0152}}\)

\(\def \ae {\unicode {x00E6}}\)

\(\def \AE {\unicode {x00C6}}\)

\(\def \aa {\unicode {x00E5}}\)

\(\def \AA {\unicode {x00C5}}\)

\(\def \o {\unicode {x00F8}}\)

\(\def \O {\unicode {x00D8}}\)

\(\def \l {\unicode {x0142}}\)

\(\def \L {\unicode {x0141}}\)

\(\def \ss {\unicode {x00DF}}\)

\(\def \SS {\unicode {x1E9E}}\)

\(\def \dag {\unicode {x2020}}\)

\(\def \ddag {\unicode {x2021}}\)

\(\def \P {\unicode {x00B6}}\)

\(\def \copyright {\unicode {x00A9}}\)

\(\def \pounds {\unicode {x00A3}}\)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\( \newcommand {\multicolumn }[3]{#3}\)

\(\require {textcomp}\)

\(\newcommand {\intertext }[1]{\text {#1}\notag \\}\)

\(\let \Hat \hat \)

\(\let \Check \check \)

\(\let \Tilde \tilde \)

\(\let \Acute \acute \)

\(\let \Grave \grave \)

\(\let \Dot \dot \)

\(\let \Ddot \ddot \)

\(\let \Breve \breve \)

\(\let \Bar \bar \)

\(\let \Vec \vec \)

</div>

<p>
<!--................................-->
<h3 id="autosec-50">Technical Specification</h3>
<a id="main-autopage-50"></a>
<a id="main-autofile-8"></a>

<a id="sec:TS"></a>
<!--................................-->
<h4 id="autosec-51"></h4>
<a id="main-autopage-51"></a>


<p>
The Technical Specification (TS) contains the developer’s response to the requirements baseline.
</p>
<!--................................-->
<h4 id="autosec-52">Response to Tokamak Science Division</h4>
<a id="main-autopage-52"></a>


<a id="sec:response_physics"></a>
<!--................................-->
<h4 id="autosec-53"></h4>
<a id="main-autopage-53"></a>
<!--................................-->
<h5 id="autosec-54">Introduction</h5>
<a id="main-autopage-54"></a>


<a id="sec:introduction"></a>

<p>
This section is Project <span class="textsc">NEPTUNE</span>’s response to Tokamak Science and MAST Upgrade Division’s Requirements Specification document. This specification was received by Wayne Arter on 5/11/20 via Rob Akers and its
authorship was confirmed to be Fulvio Militello and James Harrison at the <span class="textsc">NEPTUNE</span> Project Board. It is intended that this document helps to frame expectations of the capabilities of <span
class="textsc">NEPTUNE</span> code, as well as highlighting challenges and areas of potential collaboration. Since the main focus herein is on aspects of the physical model, the next Section&nbsp;<a
href="Software-Engineering-Response.html#sec:TS_sw_response"></a> goes into more detail regarding the software engineering needed to deliver the code successfully.
</p>

<p>
The physics requirements are summarised as:
</p>
<blockquote>

<p>
“The new UKAEA Exhaust code needs to be able to capture parallel and perpendicular transport of charged and neutral particles in 3D, full geometry and in a time dependent way. Turbulence should be self-consistently modelled, as well as energy transfer
physics between charged particles, neutrals and photons (radiation). While perturbations need to be 3D, a minimal requirement for the code is that it can simulate realistic axisymmetric equilibrium configurations with complex topologies and wall designs. The
aim of the code should be to:
</p>
<ul style="list-style-type:none">

<li>
<p>
1. Efficiently and reliably model exhaust in next generation experiments, like eg. MAST-U, JT60-SA, and especially ITER (the latter is a stringent requirement for the code).
</p>

</li>
<li>

<p>
2. Allow predictive exhaust capability for future reactor relevant machines like STEP or DEMO.”
</p>
</li>
</ul>

</blockquote>

<p>
More detailed specifications are given in the following sections either as block quotations or as bold paragraph headers.
</p>
<!--................................-->
<h6 id="autosec-56"><span class="textsc">NEPTUNE</span> Science Plan</h6>
<a id="main-autopage-56"></a>


<p>
The Science Plan for <span class="textsc">NEPTUNE</span> ref. [<a href="Index-0.html#LWR-ht-cite.0@sciplan">4</a>] is available online. The stated goal of the project is to:
</p>
<blockquote>

<p>
“develop new algorithms, software and related e-Infrastructure that will result in the efficient use of current Petascale and future Exascale supercomputing hardware in order to
</p>
<ul style="list-style-type:none">


<li>
<p>
1. draw insights from ITER “Big Data”
</p>


</li>
<li>


<p>
2. to guide and optimise the design of the UK demonstration nuclear fusion power plant STEP and related fusion technology
</p>
</li>
</ul>

<p>
in the approach to the Exascale. The aims of the work are to deliver expertise in, and tools for, “in-silico” reactor interpretation and design.”
</p>
</blockquote>

<p>
The Science Plan also describes the software development and theory development that is being and will be undertaken under <span class="textsc">NEPTUNE</span>.
</p>
<!--................................-->


<p>
<span class="paragraph" id="autosec-58">Software development.</span>
<a id="main-autopage-58"></a>
The aim of <span class="textsc">NEPTUNE</span> software development is to provide a flexible framework for implementing different physical models in an Exascale-targeted manner. In particular, the project does <em>not</em> envisage a “<span
class="textsc">NEPTUNE</span> system of equations” so much as <span class="textsc">NEPTUNE</span> providing the ability to solve a class of relevant equations, with models described relatively simply using a Domain-Specific Language (DSL).
This flexibility enables the hierarchy of models of varying fidelity and computational costs. It also allows engagement from different classes of user with different levels of physics and software expertise.
</p>
<!--................................-->


<p>
<span class="paragraph" id="autosec-59">Theory development.</span>
<a id="main-autopage-59"></a>
The above framework approach notwithstanding, <span class="textsc">NEPTUNE</span> is also supporting theory development in two of its four work packages: FM-WP2 Plasma Multiphysics Model and FM-WP3 Neutral Gas and Impurity Model. These
will develop two close coupled models, with FM-WP2 seeking to include kinetic effects in existing and new edge plasma models, and FM-WP3 developing particle-based models for describing the region outside and just inside the plasma (neutral atoms/molecules
and partially ionised impurities).
</p>

<p>
Another work package, FM-WP1 Numerical Representation, is addressing related numerical issues, such as the accurate modelling of highly anisotropic dynamics, the accurate representation of first wall geometry, and the numerical preservation of conservation
laws from the underlying models.
</p>

<p>
As such the <span class="textsc">NEPTUNE</span> plan is aligned with all the points in the summary requirements quoted above, though there are minor issues regarding the details as discussed in the following sections. It should be noted that the
Science Plan outlines a five-year programme that explicitly requires user involvement for fuller development of surrogate models (such as turbulent friction) and to specify the detailed physics of ionisation and excitation reactions. It follows that development of
many of the physics capabilities listed below will benefit greatly from a strong collaboration between Tokamak Science and Advanced Computing.
</p>
<!--................................-->
<h5 id="autosec-60">Overall Capabilities</h5>
<a id="main-autopage-60"></a>


<a id="sec:capabilities"></a>
<!--................................-->
<h6 id="autosec-61">Hierarchical approach with multiple models</h6>
<a id="main-autopage-61"></a>


<p>
“Hierarchical approach with multiple models, going from low fidelity (eg. laminar fluid and fluid-kinetic runs in 2D) to medium fidelity (eg. fluid runs with neutrals and turbulence multispecies, but with reduced number of species) and high fidelity (eg. full kinetic
or hybrid kinetic/fluid runs with turbulence and multispecies approach).”
</p>

<p>
The plan is for <span class="textsc">NEPTUNE</span> to provide a framework for solving relevant physics models, and a user-friendly Domain-Specific Language (DSL) for doing this. This allows UKAEA to develop its own physics models in a manner
significantly independent of <span class="textsc">NEPTUNE</span> development and code distribution, see Figure&nbsp;<a href="Technical-Specification.html#fig:proxyflow2">1</a>. This is the same approach as currently used by UKAEA for
BOUT++, where UKAEA has ownership of physics models in the STORM software, while other organisations have ownership of the BOUT++ framework.
</p>

<p>
Project <span class="textsc">NEPTUNE</span> intends to provide a suite of examples of physics models as part of the code distribution. As addressed in §<a href="Technical-Specification.html#sec:physics_model"></a>, there is also
development of a physics model under <span class="textsc">NEPTUNE</span> that could be adaptive, displaying a range of fidelities within different regions of the domain during a single simulation.
</p>

<figure id="autoid-2" class="figure ">
<div class="center">

<p>

<a href="./pics/proxyflow2.png" target="_blank" ><img
    src="./pics/proxyflow2.png"
    style="
    width:800pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>

<div class="figurecaption">
<p>
Figure 1:&nbsp;Development of <span class="textsc">NEPTUNE</span> software via a sequence of proxyapps. <a id="fig:proxyflow2"></a>
</p>
</div>

</figure>
<!--................................-->
<h6 id="autosec-63">Numerical efficiency</h6>
<a id="main-autopage-63"></a>


<p>
“Numerical efficiency obtained for example through scalability to large number of cores (given the expected computational resources, the code should be designed to take: \(\sim \)1 week for low fidelity parametric scans; \(\lesssim \)1 month for
medium-high fidelity runs for advanced design; \(\lesssim \)3 months for high fidelity physics studies).”
</p>

<p>
Order of magnitude estimates for the cost of code execution (see&nbsp;Section&nbsp;<a href="Order-magnitude-estimates-tokamak-edge-modelling.html#sec:cg"></a>), indicate that these timings are possible but challenging.
</p>

<p>
The plan is to target Exascale simulations that can support high-fidelity physics simulations. Project <span class="textsc">NEPTUNE</span> aims to do this in a performance portable fashion using abstraction layers to separate the physics from the
computation details. However, the challenges of Exascale mean that a degree of specialisation of the code towards available Exascale machines is expected. At some point this will probably entail trade-offs that are detrimental to performance on smaller
machines. Despite this, we still anticipate that the software should be reasonably performant for small-scale runs.
</p>
<!--................................-->
<h6 id="autosec-64">Stability of the code</h6>
<a id="main-autopage-64"></a>


<p>
“Focus on stability of the code, using (preferably) unconditionally stable numerical schemes and capability to diagnose and re-start failed runs. Ensure a small failed simulation rate for common configurations.”
</p>

<p>
The focus will be on accuracy rather than stability. An accurate solution will be a stable one, whereas the converse is not true. The use of bifurcation tracking techniques is expected to help with numerical stability. Moreover, the use of ensemble techniques (as
part of uncertainty quantification) should provide information on stability as a function of parameters, as well as making it likely that at least a subset of calculations produces usable results.
</p>

<p>
In addition, there are some planned technical solutions for diagnosing problems with runs. The simplest functionality is to allow users to change parameters when restarting a job using checkpoint files. The code can also be made to automatically check input files
(to catch user misspellings), and to output a file containing the parameters that were actually used in a simulation (in case some were accidentally overwritten). Simulations may also be given a Universally Unique Identifier (UUID) to allow provenance tracking of
simulations.
</p>
<!--................................-->
<h6 id="autosec-65">Exhaust physics modelling capability</h6>
<a id="main-autopage-65"></a>


<p>
“Provide capability to model exhaust physics all the way from sheath limited to strongly detached regimes.”
</p>

<p>
This capability follows from (1) the implemented physics models/boundary conditions, and (2) the lengthscales the code can resolve in simulations of feasible run times. Project <span class="textsc">NEPTUNE</span> anticipates that this will be feasible.
See §<a href="Technical-Specification.html#sec:physics_model"></a> for further details for the physical models.
</p>
<!--................................-->
<h6 id="autosec-66">Modern software design</h6>
<a id="main-autopage-66"></a>


<p>
“Modern software design with modular approach (independent and efficient libraries).”
</p>

<p>
Project <span class="textsc">NEPTUNE</span> is certainly adopting a modular approach to software design. This is crucial for enabling many of the desired features, as noted below. The use of reliable third-party libraries is also vital for enabling a small
team of developers to leverage the work of others, and to allow code flexibility and ease of prototyping.
</p>
<!--................................-->
<h6 id="autosec-67">Ability to integrate with other codes (eg. with IMAS).</h6>
<a id="main-autopage-67"></a>


<p>
This feature is anticipated, and will be facilitated by writing the code in object-oriented C++.
</p>

<p>
Integration with IMAS (and other data formats/standards) can be achieved by writing a module to translate between <span class="textsc">NEPTUNE</span>’s internal data structures and IMAS format. <span class="textsc">NEPTUNE</span>
developers are involved in TSVV software which will also integrate with IMAS, so will have experience in this area.
</p>
<!--................................-->
<h6 id="autosec-68">Modern visualisation tools</h6>
<a id="main-autopage-68"></a>


<p>
Integration with modern visualisation tools is not specifically addressed in the science plan. However, this is enabled by using standard data formats such as netCDF/HDF5. Auxiliary tools (similar to BOUT++’s xBOUT library) could also be developed.
</p>

<p>
The issue of <em>in situ</em> visualisation will also be important at the Exascale, with the need to interrogate large quantities of data without moving it, perhaps during a simulation. Project <span class="textsc">NEPTUNE</span> does not have specific
plans for enabling this. However, the need for this will be widespread, and we expect third-party tools/libraries to become available to support this, particularly in C++.
</p>
<!--................................-->
<h6 id="autosec-69">Accessibility (output easily catalogued and interrogated big data)</h6>
<a id="main-autopage-69"></a>


<p>
Given the constraint of producing Exascale volumes of data, it is expected that <span class="textsc">NEPTUNE</span> will default to using the Met Office practice of only saving the files necessary for repeating a simulation, rather than full outputs. It is
intended that key aspects will be captured by surrogates, descriptions of which will be saved and indexed. Users however will be able to choose to output more data and to define custom diagnostics. A modular approach to software design and the use of
standard libraries will ease the implementation of these.
</p>

<p>
In time, there will likely be a move towards creating simulation databases in preference to repeating expensive simulations. Such projects are nascent, but we have collaborators who are working in this area. Again, the modular approach and use of standard data
structures will enable interfacing with such databases as the technology matures.
</p>
<!--................................-->
<h6 id="autosec-70">Version control and user support.</h6>
<a id="main-autopage-70"></a>


<p>
Version control is a fundamental part of modern software development, and will certainly be used in <span class="textsc">NEPTUNE</span>. More generally, the project will use best software practices, including protected branches, peer reviewed pull
requests, issue trackers and automated testing. The main code contributors are familiar with such practices; we have heavy involvement from the projects BOUT++ and Nektar++ which have very high quality software practices. Project <span
class="textsc">NEPTUNE</span> also have involvement from UKAEA RSEs.
</p>

<p>
User support will be provided through issue trackers, a project Slack channel, and where relevant, through training sessions. Project <span class="textsc">NEPTUNE</span> anticipates supporting several classes of user, from those with limited software
knowledge, to users with appreciation of different numerical/algorithm choices, through to numerical/software specialists who might edit the code on a granular level. Support for such a wide range of uses is enabled by a highly modular separation-of-concerns
approach.
</p>
<!--................................-->
<h5 id="autosec-71">Physics model</h5>
<a id="main-autopage-71"></a>


<a id="sec:physics_model"></a>
<!--................................-->
<h6 id="autosec-72">General requirements</h6>
<a id="main-autopage-72"></a>
<blockquote>

<p>
“Equations need to be applicable to arbitrary aspect ratio devices.”
</p>
</blockquote>

<p>
The equations employed will not generically make the assumption of small inverse aspect ratio.
</p>
<blockquote>

<p>
The collision operators between plasma components, plasma and impurities and plasma and neutrals have to be sufficiently accurate to properly describe the radiation generated and the energy transfer between species.
</p>
</blockquote>

<p>
These operators may be included in the model being derived in FM-WP2, but at this stage simpler model operators are being used.
</p>
<blockquote>

<p>
“Photon opacity effects need to be included in the model.”
</p>
</blockquote>

<p>
The treatment of effects due to radiation are discussed in Annex&nbsp;A of ref&nbsp;<a id="main-autopage-75"></a>ref. [<a href="Index-0.html#LWR-ht-cite.0@pappeqs2">26</a>] (“the equations document"). Initial implementation will account only
for usage&nbsp;(1) <em>the calculation of source/loss terms</em>, with usage&nbsp;(2) <em>the production of synthetic spectra</em>, depending very much on input from experimentalists, as anticipated in the science plan&nbsp;ref. [<a
href="Index-0.html#LWR-ht-cite.0@sciplan">4</a>, p&#x202f;&#x0307;11].
</p>
<blockquote>

<p>
“The equations need to be capable of dealing with multiple species in non-trace amounts (at least D, T, He and seeding impurities).”
</p>
</blockquote>

<p>
The models being derived support distribution functions for multiple species.
</p>
<blockquote>

<p>
“The equations should not rely on the Boussinesq approximation.”
</p>
</blockquote>

<p>
The model derived in FM-WP2 does not use the Boussinesq approximation. Technically, this means <span class="textsc">NEPTUNE</span> will need to be able to invert three-dimensional elliptic operators with non-constant coefficients. This capability
will be available.
</p>
<blockquote>

<p>
“The code should evolve both the electron and ion energy (temperature).”
</p>
</blockquote>

<p>
This is the case with the FM-WP2 model.
</p>
<blockquote>

<p>
“It would be acceptable to have only axisymmetric equilibria, potentially corrected through small perturbations.”
</p>
</blockquote>

<p>
This is answered by the discussion in Section&nbsp;<a href="Technical-Specification.html#sec:geometry"></a>.
</p>
<!--................................-->
<h6 id="autosec-80">High fidelity simulations</h6>
<a id="main-autopage-80"></a>
<blockquote>

<p>
“In high fidelity simulations, the kinetic/fluid transition for both plasma and neutrals has to be properly captured, potentially using a multi-region approach exploiting different models in different parts of the machine could be considered (for both neutrals and
plasma); Boundary conditions need to consider improved sheath physics (collisional &amp; shallow angles); Ideally, the model should be able to treat de-magnetized ions in the divertor region; Electromagnetic effects should be included, but a perturbation
approach would be acceptable.”
</p>
</blockquote>

<p>
The Science Plan states that “FM-WP2 and FM-WP3 will concentrate upon development of the two close coupled models of the <span class="textsc">NEPTUNE</span> programme, specifically FM-WP2 around the inclusion of kinetic effects into existing
and new edge plasma models, and FM-WP3 of particle based models for describing the region outside and just inside the plasma (neutral atoms/molecules and partially ionized impurities).” See Figure&nbsp;<a
href="Technical-Specification.html#fig:colpri">2</a>.
</p>

<figure id="autoid-3" class="figure ">
<div class="center">

<p>

<a href="./png/colpri.png" target="_blank" ><img
    src="./png/colpri.png"
    style="
    width:500pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>

<div class="figurecaption">
<p>
Figure 2:&nbsp;<span class="textsc">NEPTUNE</span> software will use finite elements and particles to represent different atomic species as needed. <a id="fig:colpri"></a>
</p>
</div>

</figure>

<p>
In FM-WP2, a novel “moment-based” approach is being developed (for both plasma species and neutrals). This approach is a variant on gyrokinetics (though at present, the derivation exists only for drift kinetics). Instead of the stationary background
Maxwellian of the usual gyrokinetics, this approach uses a dynamically-varying background Maxwellian, where the particle density, bulk velocity and temperatures are allowed to vary with time. The result is a hybrid approach, where the software evolves both a
fluid system and a modified kinetic system. One of the benefits of this approach is that it gives a natural means to capture the fluid/kinetic transition, by switching between the fluid+kinetic and fluid-only descriptions. Moreover this approach allows the software
to detect which of the fluid and kinetic descriptions is valid in any region based on the properties of the modified distribution function, and therefore to automatically evolve the relevant model.
</p>

<p>
The favourable properties of this approach are valuable, but as with any novel approach there is an inherent risk of the scheme not working. Thus as described in ref&nbsp;<a id="main-autopage-82"></a>ref. [<a
href="Index-0.html#LWR-ht-cite.0@pappeqs2">26</a>, §&#x202f;1.1], in the event that this approach is not feasible, the kinetic calculations will use a Particle-in-Cell (PIC) approach. While full orbit PIC is potentially extremely expensive relative to
gyrokinetics, it has been very well-studied both in terms of theory and numerical implementation. Moreover the issue of how to treat the transition from fluid to a particles in a coupled model is well-understood, at least in classical fluid dynamics.
</p>

<p>
Relevant sheath physics boundary conditions are being derived as part of this work, including shallow angles and collisions. Ions which exit the domain re-enter as neutrals with the Knudsen cosine distribution.
</p>

<p>
While the current derivation is electrostatic, there is nothing which precludes the derivation of an electromagnetic model.
</p>
<!--................................-->
<h6 id="autosec-83">Neutrals and impurities</h6>
<a id="main-autopage-83"></a>
<!--................................-->


<p>
<span class="paragraph" id="autosec-84">Different levels of multispecies capabilities should be considered.</span>
<a id="main-autopage-84"></a>
The framework nature of the code means this will be the case.
</p>
<!--................................-->


<p>
<span class="paragraph" id="autosec-85">In medium to high fidelity models, neutrals and heavy species should be treated fully kinetically (the former have potentially low collisionality and they are not bound by the magnetic field, the latter have a large
Larmor radius).</span>
<a id="main-autopage-85"></a>

</p>

<p>
Development of a neutral gas and impurity model is ongoing under FM-WP3. Page 7 of the Science Plan states: “Kinetic levels of complexity are &#x2026;necessary &#x2026;for modelling the burning plasma regime, due to the inherent uncertainty in the fluid
codes. The plasma in a fusion reactor may well behave significantly differently to plasma in existing devices because it will in general contain two main ionic species (Deuterium and Tritium), neutral fuel particles and ionised Helium ash (or alpha particles), as
well as impurity ions originating from the wall.” That is, kinetic models will be derived and implemented, though it is hoped that this will facilitate the development of fluid models.
</p>
<!--................................-->


<p>
<span class="paragraph" id="autosec-86">In high fidelity models, dynamical neutral evolution on the turbulence time scale would be preferable, if possible.</span>
<a id="main-autopage-86"></a>
High-fidelity simulations will use a kinetic model for neutrals where appropriate.
</p>
<!--................................-->


<p>
<span class="paragraph" id="autosec-87">Ability to model pumps (either directly or via pumping surfaces) should be included. Pellets: the code should enable simulation of, or coupling to models that can model, pellet fuelling.</span>
<a id="main-autopage-87"></a>
Models for these aspects are not included in the Science Plan. As we will use an unstructured mesh, it will be possible to describe arbitrary pumping surfaces.
</p>

<p>
The role of sources and sinks is recognised to be crucial in <span class="textsc">NEPTUNE</span> physics so that modelling of pellets as a source will be possible. The tool CWIPI (Coupling With Interpolation Parallel Interface) may be used for coupling
to more complicated pellet models.
</p>
<!--................................-->
<h5 id="autosec-88">Physics capabilities</h5>
<a id="main-autopage-88"></a>


<a id="sec:physics_capabilities"></a>

<p>
“The code needs to be able to give reliable predictions of:
</p>
<ul style="list-style-type:none">

<li>
<p>
\(\bullet \) Divertor loads:
</p>
<ul style="list-style-type:none">

<li>
<p>
\(\bullet \) Reliable calculation of upstream particle and heat flux profiles: proper drift physics and upstream turbulence;
</p>

</li>
<li>

<p>
\(\bullet \) Divertor turbulence: turbulence spreading in the divertor region, effect of magnetic shear next to the X-point(s) to understand upstream/downstream connection;
</p>

</li>
<li>

<p>
\(\bullet \) Multifluid capacity to model radiation and detachment physics;
</p>

</li>
<li>

<p>
\(\bullet \) Reliable calculation of the electric field (collisionless physics near the separatrix, proper reflection of neutrals at the target);
</p>

</li>
<li>

<p>
\(\bullet \) Able to capture in/out and top/down asymmetries (geometry, drifts, radiation and detachment)
</p>
</li>
</ul>
</li>
<li>

<p>
\(\bullet \) Wall loads:
</p>
<ul style="list-style-type:none">

<li>
<p>
\(\bullet \) Should be able to predict filamentary transport and role of hot ion confinement (wall erosion)
</p>

</li>
<li>

<p>
\(\bullet \) Should calculate radiation and neutral loads (may require dedicated modules, same for divertor loads);
</p>
</li>
</ul>
</li>
<li>

<p>
\(\bullet \) Impurity transport, pumping and fueling:
</p>
<ul style="list-style-type:none">

<li>
<p>
\(\bullet \) Ability to track low (He Be), medium (C, N, Ne) and high Z impurities (W, Ar, Xe) with multiple charge states;
</p>

</li>
<li>

<p>
\(\bullet \) Reliable kinetic modelling of neutrals to assess fueling and pumping capacity;
</p>

</li>
<li>

<p>
\(\bullet \) Ability to handle non-trace species (D, T, He, seeded species), which requires new closures for the equations (if fluid, beyond Braginskii \(\implies \) Zhdanov or better);
</p>

</li>
<li>

<p>
\(\bullet \) Accurate model of friction forces (turbulence + neoclassical on open field lines);
</p>

</li>
<li>

<p>
\(\bullet \) In high fidelity models, the code should be able to simulate localized gas puffs, via injection of neutral particles.
</p>

</li>
<li>

<p>
\(\bullet \) Dust the code should enable coupling to codes to simulate dust generation, transport and ablation, via exchange of fluxes and sources.”
</p>
</li>
</ul>
</li>
</ul>
<!--................................-->


<p>
<span class="paragraph" id="autosec-89">Physics models.</span>
<a id="main-autopage-89"></a>
Many points in this section relate to the physics model. As we have alluded to above, the actual physics model used is the responsibility of the user; so, for example, it will necessary for users to derive an accurate model for turbulent friction. Moreover, as <span
class="textsc">NEPTUNE</span> will initially be an edge code, only electromagnetic radiation from the edge plasma will be calculated, and an additional model will be required for radiation for the core plasma. Nonetheless, we plan to facilitate models
which have the listed properties. In particular, our meshing approach will allow accurate representation of the walls and divertor. Thus powerful and flexible source/sink models may be used, for both volumes and surfaces.
</p>

<p>
<span class="textsc">NEPTUNE</span> code will also be capable of representing scales on which filamentary transport has been calculated to occur. The code will only produce fluxes however, and it will be up to the user to calculate wall erosion.
</p>
<!--................................-->


<p>
<span class="paragraph" id="autosec-90">Validation, Verification and Uncertainty Quantification (VVUQ).</span>
<a id="main-autopage-90"></a>
Naturally, when the solution of a problem is unknown, it is difficult to assess whether the provided answer is reliable as requested in the first line of the current section. Therefore we are integrating <span class="textsc">NEPTUNE</span> with a suite of
tools for VVUQ to enable validation of code outputs against experimental results, and provide a error bars for code outputs due to the uncertainty in the code inputs. As allowed by error estimates, models of different complexity will be used to predict key
properties of the SOL, see Figure&nbsp;<a href="Technical-Specification.html#fig:dimensions2">3</a>.
</p>
<figure id="autoid-4" class="figure ">
<div class="center">

<p>

<a href="./pics/dimensions2.png" target="_blank" ><img
    src="./pics/dimensions2.png"
    style="
    width:500pt;
    "
    class="inlineimage"
    alt="(image)"
></a>
</p>
</div>

<div class="figurecaption">
<p>
Figure 3:&nbsp;Project software will integrate a range of models of different complexity, here indicated by their dimensionality. <a id="fig:dimensions2"></a>
</p>
</div>

</figure>
<!--................................-->
<h5 id="autosec-92">Geometry</h5>
<a id="main-autopage-92"></a>


<a id="sec:geometry"></a>
<blockquote>

<p>
“Ability to handle complex topologies and novel geometries:
</p>
<ul style="list-style-type:none">

<li>
<p>
• Capacity to treat different topologies with multiple X-points (\(&gt;\)2), possibly in a dynamic way, or at least implemented in a way that does not preclude time-varying equilibria being modelled in future;
</p>


</li>
<li>


<p>
• Ability to handle singularities in the grid (null points) or to develop accurate scheme(s) that do not have singularities;
</p>


</li>
<li>


<p>
• Ability to interface with 3D CAD designs of the machine;
</p>


</li>
<li>


<p>
• Capability to handle conformal grids that go all the way to the wall for both neutrals and plasma;
</p>


</li>
<li>


<p>
• Capability to treat subdivertor structures (only neutrals).”
</p>
</li>
</ul>

</blockquote>

<p>
<span class="textsc">NEPTUNE</span> will use a spectral/hp finite element approach. This allows considerable flexibility in meshing, with elemental tetrahedra, hexahedra or prisms being used to describe complex geometries. In addition to refinement of
the elemental grid sizes (\(h\)-adaptivity), the order of the piecewise polynomial basis functions used on each element may also be changed (\(p\)-adaptivity). The production of finite element griddings conforming to CAD descriptions is standard for virtually all
meshing packages. Project <span class="textsc">NEPTUNE</span> will specially aim to use the small number of packages that may produce finite elements with curved edges and faces to exploit fully the higher order basis. This gives a framework which
can achieve spectral convergence on complicated, conforming grids, while still being able to handle discontinuities in the solution.
</p>

<p>
Should it prove necessary to produce a meshing conforming to surfaces of an equilibrium magnetic field, then because the finite element approach does not require a structured grid, it should be able to treat arbitrary geometries and topologies, in particular
including multiple X-points. The approach could be extended by further use of adaptive meshing to allow for time-varying equilibria.
</p>

</section>

</main>

</div>



</body>
</html>
